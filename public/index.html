<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>FORTUNA PLAY‚Ñ¢</title>

<!-- Metadatos para redes sociales -->
<meta property="og:title" content="FORTUNA PLAY‚Ñ¢ - üé°Gira la RUEDA DE LA FORTUNA y gana premiosüéÅüéâ">
<meta property="og:description" content="Gira la Rueda de la Fortuna cada 24 hs y gana premios incre√≠bles. Invita a tus amigos y multiplica la diversi√≥n.">
<meta property="og:image" content="https://iili.io/KYYBtaI.md.jpg"> <!-- ‚úÖ Imagen de vista previa actualizada -->
<meta property="og:url" content="https://tudominio.com/rueda.html">
<meta property="og:type" content="website">
<meta property="og:site_name" content="FORTUNA PLAY‚Ñ¢">

<style>
body { margin:0; font-family: Arial Black, sans-serif; text-align:center; color:#0ff;
  background:url('https://iili.io/KCkmp4I.md.webp') no-repeat center center fixed;
  background-size:cover; text-shadow:0 0 5px #000,0 0 8px #000; }
.logo-container { display:flex; justify-content:center; align-items:center;
  flex-direction:column; margin:5px 0; width:100%; }
#logoTop, #finalImage { max-width:45%; width:100%; height:auto; display:block;
  margin:0 auto 5px auto; filter:drop-shadow(0 0 10px #0ff);
  animation: neonLogo 2s infinite alternate; }
@keyframes neonLogo {
  0%{filter:drop-shadow(0 0 10px #0ff);}
  25%{filter:drop-shadow(0 0 15px #f0f);}
  50%{filter:drop-shadow(0 0 10px #ff0);}
  75%{filter:drop-shadow(0 0 15px #0f0);}
  100%{filter:drop-shadow(0 0 10px #0ff);}
}
.textos-superiores { text-align:center; font-size:clamp(1rem,2.5vw,1.3rem);
  font-weight:bold; line-height:1.6; margin:10px 0 15px 0; color:#0ff;
  text-shadow:0 0 5px #000,0 0 8px #000; }
#wheelContainer { position:relative; width:90vw; max-width:340px;
  margin:0 auto 5px auto; }
#wheelCanvas { width:100%; height:auto; }
#arrow { position:absolute; top:-10px; left:50%; transform:translateX(-50%);
  width:6px; height:35px; background:#fff; border-radius:2px; z-index:10; }
button { margin:5px 0; padding:12px 30px; font-size:clamp(1rem,2vw,1.2rem);
  border:none; border-radius:50px; cursor:pointer; transition:.3s; }
#spinButton { background:#ff0; color:#4b0082; font-weight:bold;
  box-shadow:0 0 10px #000; }
#winnerButton { margin-top:10px; padding:12px 25px; font-size:clamp(1rem,2vw,1.2rem);
  border-radius:50px; background:#25D366; color:#fff; cursor:pointer; border:none; }
#winnerButton:hover { transform:scale(1.08); }
#closeButton { margin-top:10px; padding:10px 20px; font-size:clamp(1rem,2vw,1.2rem);
  border-radius:50px; background:#ff4444; color:#fff; cursor:pointer; border:none; }
#winnerPopup { position:fixed; top:50%; left:50%;
  transform:translate(-50%,-50%) scale(0);
  background:rgba(0,0,0,0.95); padding:clamp(15px,4vw,25px);
  border-radius:20px; color:#0ff; font-size:clamp(1rem,3vw,1.4rem);
  text-align:center; z-index:1000; width:90%; max-width:400px; max-height:80vh;
  overflow-y:auto; border:3px solid #0ff;
  box-shadow:0 0 20px #0ff,0 0 40px #0ff,0 0 60px #0ff; }
#winnerPopup.show { transform:translate(-50%,-50%) scale(1); }
#winnerMessage,#winnerDate,#winnerReturn { margin:5px 0; }
#winnerReturn { font-weight:bold; color:#0ff;
  font-size:clamp(1rem,2.5vw,1.2rem); }
#legal,#rights { font-size:clamp(0.7rem,2vw,0.9rem); margin:2px 0;
  color:#0ff; text-shadow:0 0 5px #000,0 0 8px #000; }
#dailyCounter { margin-top:3px; font-size:clamp(0.8rem,2vw,0.95rem);
  color:#0ff; text-shadow:0 0 5px #000,0 0 8px #000; }
@media(max-width:600px){
  #logoTop{max-width:60%;}
  #wheelContainer{width:85vw;}
  button{padding:10px 20px;}
}
</style>
</head>
<body>

<div class="logo-container">
  <img id="logoTop" src="https://iili.io/KfLSxhG.md.webp" alt="Logo FORTUNA PLAY">
</div>

<div class="textos-superiores">
  üéÅ GIRA CADA 24 HS Y GANA üéÅ <br>
  üôå INVITA A TUS AMIGOS üôå <br>
  üì∏ RECORD√Å SACARLE CAPTURA A LOS PREMIOS üì∏
</div>

<div id="wheelContainer">
  <canvas id="wheelCanvas" width="340" height="340"></canvas>
  <div id="arrow"></div>
</div>

<button id="spinButton">GIRAR</button>
<div id="dailyCounter"></div>

<div id="winnerPopup">
  <div id="winnerMessage"></div>
  <div id="winnerDate"></div>
  <div id="winnerReturn"></div>
  <button id="winnerButton">Solicitar premio</button>
  <button id="closeButton">Cerrar</button>
</div>

<div class="logo-container">
  <img id="finalImage" src="https://iili.io/KK0OCrl.md.png" alt="Imagen final">
</div>

<div id="legal">+18 | Juego Responsable | Apuesta con moderaci√≥n</div>
<div id="rights">Todos los derechos reservados FORTUNA PLAY‚Ñ¢</div>

<script>
const spinBtn = document.getElementById('spinButton');
const popup = document.getElementById('winnerPopup');
const winnerMsg = document.getElementById('winnerMessage');
const winnerDate = document.getElementById('winnerDate');
const winnerReturn = document.getElementById('winnerReturn');
const winnerBtn = document.getElementById('winnerButton');
const closeBtn  = document.getElementById('closeButton');
const dailyCounter = document.getElementById('dailyCounter');

const canvas = document.getElementById('wheelCanvas');
const ctx = canvas.getContext('2d');

function getUserId(){
  let uid = localStorage.getItem("ruleta_uid");
  if(!uid){
    uid = "u_" + Math.random().toString(36).slice(2) + Date.now().toString(36);
    localStorage.setItem("ruleta_uid", uid);
  }
  return uid;
}

const colors = ["#FF0000","#00FF00","#0000FF","#FFFF00","#FF00FF","#00FFFF","#FFA500"];
let numSegments = 7;
let angleStep = (2*Math.PI)/numSegments;
let currentAngle = 0;

function drawWheel(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  for(let i=0;i<numSegments;i++){
    ctx.beginPath();
    ctx.moveTo(170,170);
    ctx.arc(170,170,170,currentAngle+i*angleStep,currentAngle+(i+1)*angleStep);
    ctx.closePath();
    ctx.fillStyle = colors[i%colors.length];
    ctx.fill();
    ctx.strokeStyle="#000";
    ctx.stroke();
  }
}
drawWheel();

function spinWheel(){
  spinBtn.disabled = true;
  const spinTime = 4000;
  const spinAngle = Math.random()*360 + 1800;
  const startAngle = currentAngle;
  const targetAngle = startAngle + spinAngle;
  const startTime = performance.now();

  function animate(time){
    let elapsed = time - startTime;
    if(elapsed < spinTime){
      const progress = elapsed / spinTime;
      currentAngle = startAngle + (spinAngle * (1 - Math.pow(1 - progress, 3)));
      drawRotatedWheel(currentAngle);
      requestAnimationFrame(animate);
    } else {
      currentAngle = targetAngle;
      drawRotatedWheel(currentAngle);
      requestResult();
    }
  }
  requestAnimationFrame(animate);
}

function drawRotatedWheel(angle){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  ctx.save();
  ctx.translate(170,170);
  ctx.rotate(angle * Math.PI / 180);
  ctx.translate(-170,-170);
  drawWheel();
  ctx.restore();
}

function requestResult(){
  fetch("/girar", {
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body: JSON.stringify({ usuarioId:getUserId() })
  })
  .then(r => r.json())
  .then(data => {
    if(data.yaGiro){
      winnerMsg.textContent = "Ganaste üéâ " + (data.premio || "") + " üéâ";
      winnerReturn.textContent = data.mensaje;
      winnerDate.textContent = "";
    } else {
      winnerMsg.textContent = "Ganaste üéâ " + data.premio + " üéâ";
      winnerDate.textContent = "Fecha y hora: " + new Date().toLocaleString();
      winnerReturn.textContent = "‚è≥ Podr√°s volver a girar en 24 horas";
      winnerBtn.onclick = () => {
        const msg = encodeURIComponent(
          `Hola ${data.cajero.nombre}! Gan√© ${data.premio} el ${new Date().toLocaleString()} y quisiera solicitarlo,gracias.`
        );
        window.open(`https://wa.me/54${data.cajero.numero}?text=${msg}`,"_blank");
      };
    }
    popup.classList.add('show');
  })
  .catch(() => { alert("Error de conexi√≥n. Intenta m√°s tarde."); })
  .finally(() => { spinBtn.disabled = false; });
}

spinBtn.addEventListener('click', spinWheel);
closeBtn.addEventListener('click', () => popup.classList.remove('show'));
</script>
</body>
</html>
